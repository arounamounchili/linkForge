# LinkForge v0.2.0 Development Plan

**Theme**: Robustness & Usability
**Target**: Q1 2026
**Status**: Planning

## Goals

1. Make LinkForge easier for new users (templates)
2. Improve error handling and user feedback (validation)
3. Strengthen code quality (type safety)
4. Ensure cross-platform compatibility

## Features Overview

| Feature | Priority | Effort | Status |
|---------|----------|--------|--------|
| Robot Templates Library | HIGH | 2-3 weeks | ğŸ“‹ Planning |
| Enhanced Validation UI | HIGH | 2-3 weeks | ğŸ“‹ Planning |
| Type Safety Cleanup | MEDIUM | 1-2 weeks | ğŸ“‹ Planning |
| Cross-Platform Testing | MEDIUM | 1 week | ğŸ“‹ Planning |

**Total Estimated Effort**: 6-9 weeks

---

## Feature 1: Robot Templates Library

### Objective
Provide pre-built robot templates that users can instantiate with one click.

### Implementation Details

**New Files**:
```
linkforge/templates/
â”œâ”€â”€ __init__.py
â”œâ”€â”€ template.py          # Template data structure
â”œâ”€â”€ loader.py            # Template loading/instantiation
â””â”€â”€ library/
    â”œâ”€â”€ arm_2dof.py
    â”œâ”€â”€ mobile_4wheel.py
    â”œâ”€â”€ gripper_parallel.py
    â””â”€â”€ arm_6dof.py
```

**Template Structure**:
```python
@dataclass
class RobotTemplate:
    name: str
    description: str
    category: str  # "arm", "mobile", "gripper", "full"
    thumbnail: str  # Path to preview image
    robot: Robot  # Pre-configured Robot instance
```

**UI Addition**:
- New panel in LinkForge tab: "Templates"
- Dropdown to select template
- Preview image
- "Create from Template" button
- Places template objects in scene at 3D cursor

**Templates to Create**:

1. **2-DOF Robot Arm** (`arm_2dof`)
   - Base link
   - 2 revolute joints
   - End effector
   - Realistic masses and inertias
   - Good for learning/testing

2. **4-Wheel Mobile Base** (`mobile_4wheel`)
   - Base chassis
   - 4 continuous joints (wheels)
   - Differential drive setup
   - Common mobile robot configuration

3. **Parallel Gripper** (`gripper_parallel`)
   - Palm link
   - 2 finger links
   - Mimic joint for synchronized closing
   - Typical gripper setup

4. **6-DOF Manipulator** (`arm_6dof`)
   - 6 revolute joints
   - Realistic arm configuration
   - End effector mounting point
   - Industry-standard joint ranges

### Testing
- Unit tests for template data structures
- Integration tests for template instantiation
- Verify all templates export valid URDF
- Test templates in RViz/Gazebo

### Documentation
- Add templates section to README
- Document how to create custom templates
- Include template screenshots

---

## Feature 2: Enhanced Validation UI

### Objective
Provide clear, actionable error messages with visual feedback.

### Implementation Details

**New Validation Panel**:
```python
class LINKFORGE_PT_validation_panel(Panel):
    """Panel showing validation results"""

    # Display:
    # - Validation status (âœ… Valid, âš ï¸ Warnings, âŒ Errors)
    # - Expandable list of issues
    # - Each issue shows:
    #   - Severity (error/warning)
    #   - Object name
    #   - Problem description
    #   - Suggested fix
    #   - "Select Object" button
    #   - "Fix" button (if auto-fixable)
```

**Validation Enhancements**:

1. **Better Error Messages**:
   ```python
   # Before:
   "Duplicate link name"

   # After:
   "Link name 'arm_link' is used by 2 links. Each link must have a unique name. Affected objects: 'Cube', 'Cube.001'"
   ```

2. **Warning System** (non-blocking):
   - Low mass links (< 0.01 kg)
   - Missing collision geometry
   - Unusual inertia values
   - Joint limits very restrictive
   - No visual geometry

3. **Auto-Fix Suggestions**:
   - Rename duplicate links â†’ "Rename to 'arm_link_2'"
   - Missing mass â†’ "Set mass to 1.0 kg"
   - Missing inertia â†’ "Calculate from geometry"

4. **Visual Highlighting**:
   - Select problematic objects in viewport
   - Optionally highlight in outliner
   - Flash outline in 3D view

**New Validation Types**:
- Check for disconnected link groups
- Verify all meshes exist
- Check for degenerate geometry (zero volume)
- Validate joint axis directions
- Check material assignments

### Testing
- Unit tests for each validation rule
- Test auto-fix functions
- Verify UI displays correctly
- Test with intentionally broken robots

### Documentation
- Document all validation rules
- Document auto-fix capabilities
- Add troubleshooting guide

---

## Feature 3: Type Safety Cleanup

### Objective
Achieve 100% mypy compliance across entire codebase.

### Implementation Details

**Files to Fix**:

1. **`linkforge/core/models/geometry.py:28`**
   - Missing type annotation for `__post_init__`
   - Add `-> None`

2. **`linkforge/core/physics/inertia.py:173`**
   - Fix tuple/Vector3 type mismatch
   - Use explicit Vector3 construction

3. **`linkforge/core/models/robot.py:141`**
   - Annotate `child_counts` as `dict[str, int]`

4. **`linkforge/core/generators/urdf.py`**
   - Fix SubElement type hints
   - Add proper type annotations to helper functions

5. **Blender integration code**
   - Add type annotations to all functions
   - Use `TYPE_CHECKING` for bpy imports
   - Add stubs for bpy types if needed

**Configuration Update**:
```toml
# pyproject.toml
[tool.mypy]
# Remove continue-on-error from CI
# Enable strict mode for all modules
```

**CI Update**:
```yaml
# .github/workflows/ci.yml
- name: Run mypy
  run: mypy linkforge  # No continue-on-error
```

### Testing
- Run mypy locally until clean
- Verify CI passes
- Check IDE type hints work correctly

### Documentation
- Document type hinting guidelines
- Add type checking to contributor docs

---

## Feature 4: Cross-Platform Testing

### Objective
Ensure LinkForge works identically on Windows, Linux, and macOS.

### Implementation Details

**Test Matrix**:

| Platform | Blender Versions | Python |
|----------|------------------|--------|
| Windows 11 | 4.2, 4.5 | 3.11 |
| Ubuntu 22.04 | 4.2, 4.5 | 3.11 |
| macOS 13 (Intel) | 4.2, 4.5 | 3.11 |
| macOS 14 (M1/M2) | 4.2, 4.5 | 3.11 |

**Testing Checklist**:
- [ ] Install extension from .zip
- [ ] Create simple robot (mark links, create joints)
- [ ] Export URDF
- [ ] Import URDF
- [ ] Export with meshes (OBJ and STL)
- [ ] Validate robot
- [ ] Test all 6 joint types
- [ ] Test all 5 geometry types
- [ ] Check UI rendering
- [ ] Verify file path handling

**Known Platform Differences**:
- Path separators (Windows `\` vs Unix `/`)
- Line endings (CRLF vs LF)
- File permissions
- Temp directory locations

**Implementation**:
- Update path handling to use `pathlib.Path`
- Ensure all file I/O uses UTF-8
- Test mesh export path normalization
- Verify symlink handling (Unix only)

**Documentation**:
- Platform-specific installation notes
- Known limitations per platform
- Troubleshooting by OS

### Testing
- Manual testing on each platform
- Document any platform-specific workarounds
- Create platform test report

---

## Technical Debt to Address

From code quality review:

1. **Unused imports** - Already cleaned âœ…
2. **Import organization** - Already fixed âœ…
3. **Type annotations** - Part of Feature 3
4. **Test coverage** - Maintain >80% on core
5. **Documentation** - Improve inline docs

---

## Development Workflow

### Phase 1: Setup (Week 1)
- Create feature branches
- Set up testing environments
- Create tracking issues on GitHub

### Phase 2: Implementation (Weeks 2-8)
- Parallel development of features
- Regular commits to feature branches
- PR reviews

### Phase 3: Integration (Week 9)
- Merge features to develop
- Integration testing
- Bug fixes

### Phase 4: Release (Week 10)
- Final testing
- Update documentation
- Create release notes
- Merge develop â†’ main
- Tag v0.2.0
- Publish release

---

## Success Criteria

### Must Have (Blocking Release)
- âœ… All 4 features implemented
- âœ… All tests passing
- âœ… Documentation updated
- âœ… Tested on at least 2 platforms

### Nice to Have
- Templates have preview images
- Video demonstration
- Published on Blender Extensions platform

---

## Tracking

**GitHub Project Board**: (To be created)
**Milestone**: v0.2.0

**Issues to Create**:
1. Feature: Robot Templates Library (#TBD)
2. Feature: Enhanced Validation UI (#TBD)
3. Technical: Type Safety Cleanup (#TBD)
4. Testing: Cross-Platform Validation (#TBD)

---

**Created**: October 2025
**Last Updated**: October 2025
**Owner**: @arounamounchili
